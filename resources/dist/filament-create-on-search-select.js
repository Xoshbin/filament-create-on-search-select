(()=>{document.addEventListener("DOMContentLoaded",function(){i()});function i(){document.querySelectorAll("[data-create-on-search-select]").forEach(e=>{f(e)})}function f(c){let e=c.querySelector("select"),t=c.querySelector(".create-on-search-select__create-button");!e||!t||(t.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation(),d(c)}),e.hasAttribute("data-searchable")&&setupSearchFunctionality(e))}function d(c){let e=c.querySelector(".create-on-search-select__modal");if(!e)return;e.style.display="flex",e.classList.add("create-on-search-select__fade-enter-active");let t=e.querySelector(".create-on-search-select__modal-content");t&&t.classList.add("create-on-search-select__scale-enter-active");let a=e.querySelector("input, textarea, select");a&&setTimeout(()=>a.focus(),100),h(c,e)}function o(c){let e=c.querySelector(".create-on-search-select__modal");if(!e)return;let t=e.querySelector(".create-on-search-select__modal-content");e.classList.remove("create-on-search-select__fade-enter-active"),e.classList.add("create-on-search-select__fade-exit-active"),t&&(t.classList.remove("create-on-search-select__scale-enter-active"),t.classList.add("create-on-search-select__scale-exit-active")),setTimeout(()=>{e.style.display="none",e.classList.remove("create-on-search-select__fade-exit-active"),t&&t.classList.remove("create-on-search-select__scale-exit-active"),_(e)},150)}function h(c,e){let t=e.querySelector('[data-action="cancel"]'),a=e.querySelector('[data-action="submit"]'),s=e.querySelector(".create-on-search-select__modal-content");t&&t.addEventListener("click",()=>o(c)),a&&a.addEventListener("click",()=>v(c)),e.addEventListener("click",n=>{n.target===e&&o(c)}),s&&s.addEventListener("click",n=>{n.stopPropagation()}),document.addEventListener("keydown",function n(l){l.key==="Escape"&&(o(c),document.removeEventListener("keydown",n))})}function v(c){let e=c.querySelector(".create-on-search-select__modal"),t=e.querySelector("form")||e,a=new FormData(t),s=Object.fromEntries(a.entries());e.querySelector("form")||e.querySelectorAll("input, textarea, select").forEach(r=>{if(r.name||r.id){let u=r.name||r.id;s[u]=r.value}});let n=new CustomEvent("createOption",{detail:{data:s},bubbles:!0});c.dispatchEvent(n)}function m(c,e){let t=document.createElement("option");t.value=e.value,t.textContent=e.label,t.selected=!0,c.appendChild(t);let a=new Event("change",{bubbles:!0});c.dispatchEvent(a)}function _(c){c.querySelectorAll("input, textarea, select").forEach(t=>{t.type==="checkbox"||t.type==="radio"?t.checked=!1:t.value=""})}window.CreateOnSearchSelect={initialize:i,openModal:d,closeModal:o,addOption:m};})();
